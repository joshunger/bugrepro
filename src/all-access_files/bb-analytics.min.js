!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){!function(b,d){if("function"==typeof define&&define.amd)define(["exports","../../../package.json"],d);else if(void 0!==c)d(c,a("../../../package.json"));else{var e={exports:{}};d(e.exports,b._package),b.event=e.exports}}(this,function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function d(a){try{window.sessionStorage&&"function"==typeof window.sessionStorage.removeItem&&window.sessionStorage.removetem(a)}catch(a){}}function e(a,b){try{b&&("string"!=typeof b&&(b=JSON.stringify(b)),window.sessionStorage&&"function"==typeof window.sessionStorage.setItem&&window.sessionStorage.setItem(a,b))}catch(a){}}function f(a){var b=void 0;try{if(window.sessionStorage&&"function"==typeof window.sessionStorage.getItem){var c=window.sessionStorage.getItem(a);c&&(b=c.match(/^(\{|\[)/)?JSON.parse(c):c)}}catch(a){}return b}function g(a,b,c,d,e,f){if(++t,f||(f={}),f.eventNumber=t,!f.mark&&"function"==typeof window.performance.mark){var g=a+b+t;window.performance.mark(g),f.mark=window.performance.getEntriesByName(g)[0].startTime}s.push({event:"bbEvent."+a,bbEvent:{event:a,category:b,action:c,label:d,value:e,fields:f}})}function h(a,b,c,d,e){g("validation."+a,"validation",b,c,d,e)}function i(a,b,c,f,h){f=f||{},f.bbUserLoginMethod=c,g("loginStateChanged","user",a?"login":"logout",b||a?"signed in":"signed out",void 0,f),a&&c?e("bbUserLoginMethod",c):a||d("bbUserLoginMethod"),a&&h&&l(h,s)}function j(a,b,c,d,e){var f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k={};try{f=new w(b||window.location.href)}catch(a){}g=e?e.constructor.name:"exception",h="error",i=f?f.fileName+":"+c+"("+d+")":"exception",j=a,k.line=c,k.col=d,e&&(k.stack=e.stack),s.push({event:"bbEvent.exception",bbException:{event:g,category:h,action:i,label:j,fields:k}})}function k(a,b,c,d){var e="error-page";if(a>=400&&a<500)switch(a){case 404:e="not found";break;case 401:e="unauthorized";break;case 403:e="forbidden";break;default:e="client error"}else if(a>=500)switch(a){case 503:e="gateway timeout";break;default:e="server error"}g(e,"error",b,c,void 0,d)}function l(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=f("bbUserLoginMethod"),d=void 0;a&&(d={event:"bbEvent.userDataLoaded",userId:a.userId,bbUserKruxId:a.hashedEmail,bbUserLoggedInStatus:!0,bbUserJoinDate:new Date(1e3*a.joinDate).toUTCString(),bbUserLastLogin:new Date(1e3*a.lastLogin).toUTCString(),bbUserHomeCountry:a.country,bbUserHomeState:a.state,bbUserHomeCity:a.city,bbUserGoalsBodyFat:a.weightGoal,bbUserGoalsPhysique:a.goalPhysique,bbUserMilitaryBranch:a.militaryBranch,bbForumUserRep:a.forumRep},a.mainGoal&&(d.bbUserGoalsMain=a.mainGoal.code)),c&&(d=d||{},d.bbUserLoginMethod=c),d&&b.push(d)}function m(a,b,c,d){if(!d&&window.performance&&"function"==typeof window.performance.mark){var e=a+"."+b;window.performance.mark(e),d=window.performance.getEntriesByName(e,"mark"),"array"===d.constructor.name.toLowerCase()&&(d=d[d.length-1]),d=d.startTime}d&&s.push({event:"bbEvent.timing",bbTiming:{hitType:"timing",category:a,variable:b,value:d,label:c}})}function n(a,b){return a.name+"["+a.markIndex+"]["+ ++a.counter+"]"+(b?"."+b:"")}function o(a){var b=void 0;return v.mark&&(window.performance.mark(a),b=window.performance.getEntriesByName(a,"mark")),b}function p(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};d.bbPageName=a,d.event="pageview",b&&(d.bbPageType=b),c&&(d.bbPageSubType=c),s.push(d)}function q(a){for(var b={},c=!0,d=/^(body|html|head)$/,e=a.localName.match(d)?a:a.parentNode;e&&c;)e&&e.localName&&!e.localName.match(d)||(c=!1),e.dataset&&Object.keys(e.dataset).filter(function(a){return a.match(/^bbZone\d+$/)}).forEach(function(a){b[a]=b[a]||e.dataset[a],e.dataset.bbPosition&&(b[a+"_position"]=e.dataset.bbPosition)}),c=!b.bbZone1,e=e.parentNode;return b}Object.defineProperty(a,"__esModule",{value:!0}),a.sessionSet=e,a.sessionGet=f,a.pushEvent=g,a.validationError=h,a.loginStateChanged=i,a.pushException=j,a.fauxErrorPage=k,a.populateProfile=l,a.pushTiming=m,a.pageView=p,a.getClickZones=q;var r=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),s=window.dataLayer||[],t=(a.version=b.version,0),u=0,v={mark:!(!window.performance||"function"!=typeof window.performance.mark),measure:!(!window.performance||"function"!=typeof window.performance.measure)},w=(a.PerformanceMeasure=function(){function a(b,d){c(this,a),this.category=b,this.name=d,this.markIndex=++u,this.counter=0}return r(a,[{key:"start",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.startMark=o(n(this)),this.startMark&&"array"===this.startMark.constructor.name.toLowerCase()&&(this.startMark=this.startMark[this.startMark.length-1]),b&&this.startMark&&m(this.category,this.name,a,this.startMark.startTime),this}},{key:"measure",value:function(a){var b=void 0;if(window.performance&&"function"==typeof window.performance.measure){var c=n(this),d=o(c);if(d&&"array"===d.constructor.name.toLowerCase()&&(d=d[d.length-1]),d&&this.startMark&&v.measure){var e=n(this,a);window.performance.measure(e,this.startMark.name,d.name),b=window.performance.getEntriesByName(e,"measure"),b&&"array"===b.constructor.name.toLowerCase()&&(b=b[b.length-1]),m(this.category,this.name,a,b.duration)}}return b}}]),a}(),a.UrlUtil=function a(b){var d=this;if(c(this,a),void 0===b||null===b)throw new Error('Cannot construct URL from "'+b+'"');var e=void 0;if(b.match(/^https?:\/\/.*/))e=new URL(b);else{var f=window.location,g=void 0;g=b.match(/^\/.*/)?f.protocol+"/":f.protocol+"//"+f.hostname+"/",e=new URL(""+g+b)}for(var h in e)"function"!=typeof h&&(this[h]=e[h]);Object.keys(e).forEach(function(a){d[a]=e[a]}),this.domain=this.hostname.replace(/^(.+\.)*(\w.*)\.\w+$/,"$2"),this.domain||(this.domain=this.hostname),this.fileName=(this.pathname||this.path||"").replace(/.*\/(.+)\/?$/)})})},{"../../../package.json":24}],2:[function(a,b,c){!function(a,d){if("function"==typeof define&&define.amd)define(["module","exports"],d);else if(void 0!==c)d(b,c);else{var e={exports:{}};d(e,e.exports),a.getCookie=e.exports}}(this,function(a,b){"use strict";function c(a){var b=a+"=",c=document.cookie.split(";"),d="",e={},f=void 0,g=void 0;for(g=0;g<c.length;g++){for(f=c[g];" "==f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(b)){if(d=decodeURIComponent(f.substring(b.length,f.length)),"{"==d.substring(0,1))try{if("v"in(e=JSON.parse(d)))return e.v}catch(a){return d}if("undefined"==d)return;return d}}return null}Object.defineProperty(b,"__esModule",{value:!0}),b.getCookie=c,a.exports=c})},{}],3:[function(a,b,c){!function(a,b){if("function"==typeof define&&define.amd)define(["exports"],b);else if(void 0!==c)b(c);else{var d={exports:{}};b(d.exports),a.getMeta=d.exports}}(this,function(a){"use strict";function b(a){return a.replace(/-([a-z])/gi,function(a,b){return b.toUpperCase()})}function c(a){var c=void 0;return c=document.querySelector('meta[name="'+a+'"]'),c?c.getAttribute("content"):window[b(a)]}Object.defineProperty(a,"__esModule",{value:!0}),a.getMeta=c})},{}],4:[function(a,b,c){!function(b,d){if("function"==typeof define&&define.amd)define(["exports","./event"],d);else if(void 0!==c)d(c,a("./event"));else{var e={exports:{}};d(e.exports,b.event),b.globalClickHandler=e.exports}}(this,function(a,b){"use strict";function c(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function d(a){var d=new Set(["bbCategory","bbAction","bbLabel","bbValue"]),e=new Set(["checkbox","radio"]),f=a.target,g=f.localName,h="a"===g;if(!(f.dataset&&f.dataset.bbDnt||"label"===f.localName&&f.for)){var i=f.dataset&&f.dataset.bbCategory?f.dataset.bbCategory:"bb.wrapper",j=void 0;if(f.dataset&&f.dataset.bbAction)j=f.dataset.bbAction;else if(h)j="link.click";else if("button"===f.localName||f.type&&f.type.match(/^(button|submit)$/))j="button.click";else if("reset"===f.type)j="reset.click";else if("file"===f.type)j="file.open";else if("select"===f.localName)j="option.selected";else{if("checkbox"!==f.type&&"radio"!==f.type)return;j=f.type}"checkbox"!==f.type&&"radio"!==f.type||(f.checked&&!j.match(/\.selected$/)?j=(j||f.type)+".selected":f.checked||j.match(/\.unselected$/)||(j=(j||f.type)+".unselected"));var k=0;f.dataset&&f.dataset.bbValue&&(k=f.dataset.bbValue);var l={eventType:a.type,x:f.offsetLeft,y:f.offsetTop,width:f.clientWidth,height:f.clientHeight,elementId:f.id,elementClass:"."+[].concat(c(f.classList)).sort().join("."),elementType:"input"===g?g+"."+f.type:g};h?(f.href&&(l.href=f.href,l.isExit=!f.href.match(/^(\/?w+.*|https?:\/\/(\w+\.)*bodybuilding\.com.*)$/),l.isExit&&(f.dataset.bbExitType?l.exitType=f.dataset.bbExitType:f.href.match(/^(\/|https?:\/\/).+/)?l.exitType=new b.UrlUtil(f.href).domain:l.exitType="deep-link",l.exitType||(l.exitType="offsite"))),l.name=f.rel):f.name&&(l.name=f.name);var m=void 0;if(f.dataset&&f.dataset.bbLabel)m=f.dataset.bbLabel;else if(h)m=f.rel||l.name;else if(e.has(f.type))m=f.value;else if("select"===f.localName){var n=f.querySelector("[selected]");n&&(n.dataset&&(n.dataset.bbLabel&&(m=n.dataset.bbLabel),n.dataset.bbAction&&(m=n.dataset.bbAction),n.dataset.bbCategory&&(m=n.dataset.bbCategory),n.dataset.bbValue&&(m=n.dataset.bbValue)),!m&&n.value&&(m=n.value),m&&(m=(n.innerText||"").trim()))}m||(m=j+(l.name?" "+l.name:"")),a.timeStamp&&(l.mark=a.timeStamp),f.dataset&&Object.keys(f.dataset).forEach(function(a){d.has(a)||(l[a]=f.dataset[a])});var o=(0,b.getClickZones)(f);(0,b.pushEvent)("click",i,j,m,k,Object.assign(o,l))}}Object.defineProperty(a,"__esModule",{value:!0}),a.listener=d})},{"./event":1}],5:[function(a,b,c){!function(b,d){if("function"==typeof define&&define.amd)define(["exports","./global-click-handler","./user-shim","./event","./get-meta","@bbcom/datalayer-validator/datalayer-validator","./get-cookie"],d);else if(void 0!==c)d(c,a("./global-click-handler"),a("./user-shim"),a("./event"),a("./get-meta"),a("@bbcom/datalayer-validator/datalayer-validator"),a("./get-cookie"));else{var e={exports:{}};d(e.exports,b.globalClickHandler,b.userShim,b.event,b.getMeta,b.datalayerValidator,b.getCookie),b.onload=e.exports}}(this,function(a,b,c,d,e,f,g){"use strict";function h(a){return a&&a.__esModule?a:{default:a}}function i(){function a(){function a(a){a.event="bbEvent.documentReady",Object.keys(a).length>1&&(Object.keys(a).forEach(function(b){null!==a[b]&&""!==a[b]||(a[b]=void 0)}),m.push(a))}var f={};window.document.body.addEventListener("click",b.listener),window.document.body.addEventListener("touchend",b.listener);var g=function(){var a={};if(Math.random()>.5){var b=JSON.parse(sessionStorage.getItem(n)||"{}");b[window.location.href]||(window.navigator.hardwareConcurrency&&(a.bbMetaHardwareConcurrency=window.navigator.hardwareConcurrency),window.performance&&(window.performance.memory&&(a.bbMetaTotalJSHeapSize=window.performance.memory.totalJSHeapSize,a.bbMetaUsedJSHeapSize=window.performance.memory.usedJSHeapSize,a.bbMetaJSHeapSizeLimit=window.performance.memory.jsHeapSizeLimit),window.performance.navigation&&(a.bbMetaRedirectCount=window.performance.navigation.redirectCount)),b[window.location.href]=!0,(0,d.sessionSet)(n,b))}return a}();new c.UserShim(function(){return!0}).shim().then(function(b){a(Object.assign(f,g,b))}).catch(function(){a(Object.assign(f,g))}),"disabled"!==(0,e.getMeta)("bb-analytics-validate")&&setTimeout(function(){return j.default.log(window.dataLayer)},2100)}var f={event:"dataLayer-loaded"};window.onerror=function(a,b,c,e,f){"object"===(void 0===a?"undefined":l(a))?(0,d.pushException)(a.message,b,c,e,f||a):(0,d.pushException)(a,b,c,e,f)};var g=(0,d.sessionGet)("bbPageTabId");if(!g){var h=Date.now();g="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=(h+16*Math.random())%16|0;return h=Math.floor(h/16),("x"===a?b:3&b|8).toString(16)}),(0,d.sessionSet)("bbPageTabId",g)}f.bbPageTabId=g,"disabled"!==(0,e.getMeta)("bb-shim-dl-user")&&(f.bbUserMachineId=(0,k.default)("m"),f.bMetaOmnitureVisitorId=((0,k.default)("s_vi")||"").replace(/\[CS]\w+\|(\w+-\w+)\[CE]/,"$1")),window.onerror=function(a,b,c,e,f){"object"===(void 0===a?"undefined":l(a))?(0,d.pushException)(a.message,b,c,e,f||a):(0,d.pushException)(a,b,c,e,f)},/in/.test(window.document.readyState)?window.document.addEventListener("DOMContentLoaded",a):a(),m.push(f)}Object.defineProperty(a,"__esModule",{value:!0}),a.register=i;var j=h(f),k=h(g),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},m=window.dataLayer||[],n="bba.perf"})},{"./event":1,"./get-cookie":2,"./get-meta":3,"./global-click-handler":4,"./user-shim":6,"@bbcom/datalayer-validator/datalayer-validator":8}],6:[function(a,b,c){!function(b,d){if("function"==typeof define&&define.amd)define(["exports","./get-cookie","./event","./get-meta"],d);else if(void 0!==c)d(c,a("./get-cookie"),a("./event"),a("./get-meta"));else{var e={exports:{}};d(e.exports,b.getCookie,b.event,b.getMeta),b.userShim=e.exports}}(this,function(a,b,c,d){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0}),a.UserShim=a.PROFILE_KEY=void 0;var f=function(a){return a&&a.__esModule?a:{default:a}}(b),g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a.PROFILE_KEY="bba.profile";a.UserShim=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0};e(this,a),this.enabled=b()}return g(a,[{key:"shim",value:function(){return new Promise(function(a){var b={};if("disabled"===(0,d.getMeta)("bb-shim-dl-user")||(0,c.sessionGet)(h))a(b);else{b.bbUserMachineId=(0,f.default)("m"),b.bMetaOmnitureVisitorId=((0,f.default)("s_vi")||"").replace(/\[CS]\w+\|(\w+-\w+)\[CE]/,"$1");var e=new XMLHttpRequest;e.addEventListener("error",function(){a(b)}),e.addEventListener("abort",function(){a(b)}),e.addEventListener("load",function(){if(200===e.status){var d=JSON.parse(e.responseText),f=[];(0,c.populateProfile)(d,f),f.reduce(function(a,b){return Object.assign(a,b||{})},b),b=f[0]}(0,c.sessionSet)(h,b),a(b)});var g=(0,d.getMeta)("bb:profile-api-root")||"https://api.bodybuilding.com/profile/me";e.open("GET",g),e.setRequestHeader("accept","application/json"),e.withCredentials=!0,e.send()}})}}]),a}()})},{"./event":1,"./get-cookie":2,"./get-meta":3}],7:[function(a,b,c){!function(b,d){if("function"==typeof define&&define.amd)define(["exports","@bbcom/datalayer-validator","./bb/analytics/event","./bb/analytics/get-cookie","./bb/analytics/onload","./bb/analytics/global-click-handler","../package.json"],d);else if(void 0!==c)d(c,a("@bbcom/datalayer-validator"),a("./bb/analytics/event"),a("./bb/analytics/get-cookie"),a("./bb/analytics/onload"),a("./bb/analytics/global-click-handler"),a("../package.json"));else{var e={exports:{}};d(e.exports,b.datalayerValidator,b.event,b.getCookie,b.onload,b.globalClickHandler,b._package),b.exports=e.exports}}(this,function(a,b,c,d,e,f,g){"use strict";function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0}),a.bbAnalytics=void 0;var i=function(a){return a&&a.__esModule?a:{default:a}}(b),j=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),k=a.bbAnalytics={version:g.version,event:{pushEvent:c.pushEvent,fauxErrorPage:c.fauxErrorPage,loginStateChanged:c.loginStateChanged,validationError:c.validationError,pushException:c.pushException,pageView:c.pageView,populateProfile:c.populateProfile,pushTiming:c.pushTiming,PerformanceMeasure:c.PerformanceMeasure,getClickZones:c.getClickZones},getCookie:d.getCookie,validator:i.default,globalClickHandler:f.listener},l=function(){function a(){h(this,a)}return j(a,[{key:"dataLayerObject",value:function(){return i.default.merge(window.dataLayer)}},{key:"dataLayerArray",value:function(){return window.dataLayer}},{key:"events",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:/.*/;return window.dataLayer.filter(function(b){return b.event&&b.event.match(a)})}},{key:"eventNames",value:function(){console.log(this.events().map(event.event).join("\n"))}},{key:"logBbEvents",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:/^bbEvent.*$/,b=this.events(a).map(function(a){var b={event:a.event};a.bbEvent&&a.bbEvent.event&&(b["bbEvent.event"]=a.bbEvent.event);var c=Object.assign({},a.bbEvent,b);return c.fields&&Object.keys(c.fields).forEach(function(a){return c["fields."+a]=c.fields[a]}),delete c.fields,c});console.table(b)}}]),a}();k.debugger=new l,window.bbAnalytics=k,(0,e.register)()})},{"../package.json":24,"./bb/analytics/event":1,"./bb/analytics/get-cookie":2,"./bb/analytics/global-click-handler":4,"./bb/analytics/onload":5,"@bbcom/datalayer-validator":8}],8:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","./lib/merge","./lib/root-validator","./package"],e);else if(void 0!==c)e(b,a("./lib/merge"),a("./lib/root-validator"),a("./package"));else{var f={exports:{}};e(f,d.merge,d.rootValidator,d._package),d.datalayerValidator=f.exports}}(this,function(a,b,c,d){"use strict";var e={version:d.version,validate:function(a){return new c(a).validate()},merge:b,rules:function(a){return new c(a).ruleSet()}};e.log=function(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],c=new Set(e.rules(a)),d=e.validate(a),f={failure:"color:#F80;font-weight:bold;",error:"color:red;font-weight:bold;",skipped:"color:gray;font-weight:bold;",passed:"color:green;font-weight:bold;"};console.log("%cData Layer Validation:","font-size: 120%; font-weight:bold;"),d.forEach(function(a){c.delete(a.rule),console.log("\t%c%s\t:\t%s - %s",f[a.rule.severity],a.rule.severity.toUpperCase(),a.rule.fqn,a.message)}),b&&c.forEach(function(a){return console.log("\t%cSUCCESS\t:\t%s",f.passed,a.fqn,a.describe())}),console.log("datalayer-validator v1.2.3")};try{window.dataLayerValidator=e}catch(a){console.log("############## Not in browser...")}a.exports=e})},{"./lib/merge":15,"./lib/root-validator":17,"./package":23}],9:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","./validator","./rule"],e);else if(void 0!==c)e(b,a("./validator"),a("./rule"));else{var f={exports:{}};e(f,d.validator,d.rule),d.basicValidator=f.exports}}(this,function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=["bbPageSiteSection","bbPageName","bbPageType","bbPageSubType","bbMetaOmnitureVisitorId","bbUserMachineId","bbWrapperVersion","bbServer.version","bbServer.name","bbClient.version","bbClient.name"].map(function(a){return new c.RequiredRule(a)}).concat([new c.RestrictKeyRule(new Set(["store","content","bodyspace","forum","search"]),"bbPageSiteSection")]),i=function(a){function b(a){return d(this,b),e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,h))}return f(b,a),g(b,[{key:"shouldBeApplied",value:function(){return!0}}]),b}(b);a.exports=i})},{"./rule":18,"./validator":21}],10:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","./validator","./rule"],e);else if(void 0!==c)e(b,a("./validator"),a("./rule"));else{var f={exports:{}};e(f,d.validator,d.rule),d.contentValidator=f.exports}}(this,function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=["bbContentType","bbContentTemplate","bbContentAuthor","bbContentPublishDate","bbContentModifiedDate","bbAdCount","bbPageSharesFB","bbPageSharesInstagram","bbPageSharesTwitter","bbReadTimeEstimate","bbPageTargetTimeOnPage","bbContentArticleWords","bbContentSummaryWords"].map(function(a){return new c.RequiredRule(a)}),i=["bbArticleTitle","bbArticleCategory","bbArticleRatingCount","bbArticleRating"].map(function(a){return new c.RequiredRule(a)}),j=new b(h,[],"contentCore"),k=new b(i,[],"article"),l=new Set(["article"]),m=function(a){function b(a){var f;d(this,b);var g=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,[new c.RestrictKeyRule(l,"bbContentType")],"contentSuite")),h=(a.bbContentType||"").toLowerCase();switch(g.rules=g.rules.concat(j.rules),h){case"article":g.rules=g.rules.concat(k.rules);break;default:g.shouldBeApplied()&&console.log('No rules for content type "%s"',h)}return f=g,e(g,f)}return f(b,a),g(b,[{key:"shouldBeApplied",value:function(){return"content"===this.sourceObject.bbPageSiteSection}}]),b}(b);a.exports=m})},{"./rule":18,"./validator":21}],11:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","../validator","../rule","./product"],e);else if(void 0!==c)e(b,a("../validator"),a("../rule"),a("./product"));else{var f={exports:{}};e(f,d.validator,d.rule,d.product),d.ecommerceItem=f.exports}}(this,function(a,b,c,d){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},j=function(a){function j(a,g){var h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{eventNames:new Set,requiredProps:new Set};e(this,j);var i=f(this,(j.__proto__||Object.getPrototypeOf(j)).call(this,g,function(){var e=[];h.eventNames.size>0&&e.push(new c.RestrictKeyRule(h.eventNames,"event"));!function b(){var d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Set,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ecommerce."+a;d.forEach(function(a){e.push(new c.RequiredRule(a,""+f)),h[a]&&h[a].requiredProps&&b(h[a].requiredProps,f+"."+a)})}(h.requiredProps);var f=[],i=b.create(g,e,"ecommerce."+a+".core",function(){return!(!g.ecommerce||!g.ecommerce[a])});return f.push(i),h.requiredProps.has("products")&&g.ecommerce&&g.ecommerce[a]&&(g.ecommerce[a].products||[]).forEach(function(b,c){f.push(new d(b,a,c))}),f},a));return i.config=Object.assign({},h),i}return g(j,a),h(j,[{key:"shouldBeApplied",value:function(){return!(!this.sourceObject.ecommerce||!this.sourceObject.ecommerce[this.name])}},{key:"validate",value:function(){return i(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"validate",this).call(this)}}]),j}(b.ChainedValidator);a.exports=j})},{"../rule":18,"../validator":21,"./product":13}],12:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","../rule","../validator","./ecommerce-item"],e);else if(void 0!==c)e(b,a("../rule"),a("../validator"),a("./ecommerce-item"));else{var f={exports:{}};e(f,d.rule,d.validator,d.ecommerceItem),d.enhancedEcommerce=f.exports}}(this,function(a,b,c,d){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},j={click:{eventNames:new Set(["productClick"]),requiredProps:new Set(["products"]),Validator:d},impressions:{eventNames:new Set([]),requiredProps:new Set([]),Validator:d},detail:{eventNames:new Set([]),requiredProps:new Set(["products"]),Validator:d},add:{eventNames:new Set(["add-to-cart"]),requiredProps:new Set(["products"]),Validator:d},remove:{eventNames:new Set(["remove-from-cart"]),requiredProps:new Set(["products"]),Validator:d},checkout:{eventNames:new Set(["checkout"]),requiredProps:new Set(["products"]),Validator:d,actionField:{requiredProps:new Set(["step","option"])}},checkout_option:{eventNames:new Set(["checkoutOption"]),requiredProps:new Set(["actionField"]),Validator:d,actionField:{requiredProps:new Set(["step","option"])}},purchase:{eventNames:new Set(["purchase"]),requiredProps:new Set(["actionField","products"]),Validator:d,actionField:{requiredProps:new Set(["id","revenue","shipping","tax"])}},refund:{eventNames:new Set([]),requiredProps:new Set([]),Validator:d},promoView:{eventNames:new Set([]),requiredProps:new Set(["promotions"]),Validator:d},promoClick:{eventNames:new Set(["promotionClick"]),requiredProps:new Set(["promotions"]),Validator:d}},k=function(a){function d(a){return e(this,d),f(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,a,function(){var d=[new b.RequiredRule("currencyCode","ecommerce")],e=[c.create(a,d,"ecommerce.basic",!0)];return Object.keys(j).forEach(function(b){var c=new j[b].Validator(b,a,j[b]);e.push(c)}),e.slice(0)},"enhancedEcommerceSuite"))}return g(d,a),h(d,[{key:"shouldBeApplied",value:function(){return this.sourceObject.ecommerce}},{key:"validate",value:function(){return i(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"validate",this).call(this)}}]),d}(c.ChainedValidator);a.exports=k})},{"../rule":18,"../validator":21,"./ecommerce-item":11}],13:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","../rule","../validator"],e);else if(void 0!==c)e(b,a("../rule"),a("../validator"));else{var f={exports:{}};e(f,d.rule,d.validator),d.product=f.exports}}(this,function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},i=b.RequiredRule,j={averageRating:"dimension124",hasPromotion:"dimension125",sizeOption:"dimension126",sizeOptionLabel:"dimension127",servingSize:"dimension128",skuId:"dimension129",variantRating:"dimension130"},k=function(a){function b(a,c){d(this,b);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,j[a],c));return f.dimensionName=a,f}return f(b,a),g(b,[{key:"violated",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"violated",this).call(this,a+" ["+this.name+" = "+this.dimensionName+"]",c)}},{key:"test",value:function(){return h(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"test",this).call(this)}},{key:"describe",value:function(){return"Expect that "+this.name+" a.k.a. "+j[this.dimensionName]+" is present on "+this.fqn+"."}}]),b}(b.RequiredRule),l=[/.*(lb|tons|oz|ounce|ounces).*/,/.*\b(kg|g|mg)\b.*/,/.*(amu|newton).*/,/.*(stone).*/],m=[/.*(small|sm).*/,/.*(medium|med).*/,/.*(large|lg).*/,/.*(xl|2xl|3xl|xs).*/,/.*(xlarge|x-large|xlg).*/,/.*(xxlarge|xx-large|xxlg).*/,/.*(xxxlarge|xxx-large|xxxlg).*/],n=function(a){function c(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*",f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"n";return d(this,c),e(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,"not.sizey","ecommerce","ecommerce."+a+".products["+f+"].variant",b.severities.failure))}return f(c,a),g(c,[{key:"test",value:function(a){
for(var b=0;b<l.length;b++)if(a.variant.toLowerCase().match(l[b]))return this.violated('Product variant cannot contain weights !"'+a.variant+'" matched on pattern '+l[b]+"!",{product:a,pattern:l[b]});for(var c=0;c<m.length;c++)if(a.variant.toLowerCase().match(m[c]))return this.violated('Product variant cannot contain sizes !"'+a.variant+'" matched on pattern '+m[c]+" !",{product:a,pattern:m[c]})}},{key:"describe",value:function(){return"Expect product option "+this.fqn+" NOT to resemble a size. (size should be set in "+this.context+"."+j.sizeOption+")"}}]),c}(b),o=function(a){function c(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",g=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"n";d(this,c);var h=e(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,a,[],"ecommerce."+f+".products["+g+"]")),j="ecommerce."+f+".products["+g+"]";return h.rules=[new i("id",j),new i("name",j),new i("price",j),new i("brand",j),new i("category",j),new b.RestrictKeyRule(new Set(["SUPPLEMENT","CLOTHING","ACCESSORY","MEDIA","COMBO"]),"category",j),new k("skuId",j)],a.variant&&h.rules.push(new n(f,g)),h}return f(c,a),g(c,[{key:"shouldBeApplied",value:function(){return!0}},{key:"validate",value:function(){return h(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"validate",this).call(this)}}]),c}(c);a.exports=o})},{"../rule":18,"../validator":21}],14:[function(a,b,c){!function(a,d){if("function"==typeof define&&define.amd)define(["module"],d);else if(void 0!==c)d(b);else{var e={exports:{}};d(e),a.getCookie=e.exports}}(this,function(a){"use strict";function b(a){var b=a+"=",c=void 0,d="",e={},f=void 0,g=void 0;try{c=(window.document||{cookie:""}).cookie.split(";")}catch(a){return null}for(g=0;g<c.length;g++){for(f=c[g];" "==f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(b)){if(d=decodeURIComponent(f.substring(b.length,f.length)),"{"==d.substring(0,1))try{if("v"in(e=JSON.parse(d)))return e.v}catch(a){return d}if("undefined"==d)return;return d}}return null}a.exports=b})},{}],15:[function(a,b,c){!function(a,d){if("function"==typeof define&&define.amd)define(["module"],d);else if(void 0!==c)d(b);else{var e={exports:{}};d(e),a.merge=e.exports}}(this,function(a){"use strict";a.exports=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b={};return a||(a=window.dataLayer),a||(console.log("No datalayer!"),a=[]),a.forEach(function(a){Object.keys(a).forEach(function(c){return b[c]=a[c]})}),b}})},{}],16:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","./validator"],e);else if(void 0!==c)e(b,a("./validator"));else{var f={exports:{}};e(f,d.validator),d.pageTypeValidator=f.exports}}(this,function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function d(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(a){function g(a){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{rules:[]},f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};c(this,g);var h=d(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,f,function(){var c=[];return Object.keys(e).forEach(function(a){"rules"===a?c=c.concat(e[a]):f.bbPageSubType===a&&e[a].rules&&(c=c.concat(e[a].rules))}),[b.create(f,c,"bbPageType."+a,!0)]},a));return h.config=e,h}return e(g,a),f(g,[{key:"shouldBeApplied",value:function(){return!0}}]),g}(b.ChainedValidator);a.exports=g})},{"./validator":21}],17:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","./basic-validator","./user-validator","./store-page-validator","./merge","./rule","./content-validator"],e);else if(void 0!==c)e(b,a("./basic-validator"),a("./user-validator"),a("./store-page-validator"),a("./merge"),a("./rule"),a("./content-validator"));else{var f={exports:{}};e(f,d.basicValidator,d.userValidator,d.storePageValidator,d.merge,d.rule,d.contentValidator),d.rootValidator=f.exports}}(this,function(a,b,c,d,e,f,g){"use strict";function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function j(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},l=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),m=function(a){function b(){return h(this,b),i(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"max-noscript-url","noscript","",f.severities.error))}return j(b,a),l(b,[{key:"test",value:function(a){function b(a){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",d="";return"object"===(void 0===a?"undefined":k(a))&&(d+=Object.keys(a).map(function(d){var e=a[d];if("object"===(void 0===e?"undefined":k(e)))return b(e,d);var f=d;return c&&"string"==typeof c&&(f=c+"."+d),f+"="+e}).join("&")),d}var c=void 0;try{a=a||window.dataLayer;for(var d=0;d<a.length;d++){var e=a[d],f=b(e);if(f.length>8192){c=this.violated("Item in dataLayer with length of "+f.length+" exceeds maximum url length of 8192 for noscript iframe.",{value:e});break}}}catch(a){console.log("No dataLayer or no window object...")}return c}}]),b}(f),n=new m,o=function(){function a(){var f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];h(this,a),this.dataLayer=f,this.mergedDataLayer=e(f),this.validators=[new b(this.mergedDataLayer),new c(this.mergedDataLayer),new d(this.mergedDataLayer),new g(this.mergedDataLayer)]}return l(a,[{key:"ruleSet",value:function(){var a=this.validators.filter(function(a){return a.shouldBeApplied()}).map(function(a){return a.rules}).reduce(function(a,b){return a.concat(b)});return a.push(n),this.rules=a,this.rules}},{key:"validate",value:function(){var a=this.validators.filter(function(a){return a.shouldBeApplied()}).map(function(a){return a.validate()}).reduce(function(a,b){return a.concat(b)}),b=n.test(this.dataLayer);return b&&a.push(b),a}}]),a}();a.exports=o})},{"./basic-validator":9,"./content-validator":10,"./merge":15,"./rule":18,"./store-page-validator":19,"./user-validator":20}],18:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","./violation"],e);else if(void 0!==c)e(b,a("./violation"));else{var f={exports:{}};e(f,d.violation),d.rule=f.exports}}(this,function(a,b){"use strict";function c(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function d(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c=a.split("."),d=b;c.length>0&&(d=d[c.shift()]););return d}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h={required:"required",unknownKey:"unknown-key",exception:"exception",contradictingState:"contradicting-state",invalidType:"invalid-type",equals:"equals",stringMatches:"string-matches"},i={failure:"failure",error:"error",skipped:"skipped"},j=function(){function a(b,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.failure;e(this,a);var g=d?d+"."+b:b;this.context=d,this.name=b,this.fqn=g,this.category=c,this.severity=f}return g(a,[{key:"violated",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new b(this,a,c)}},{key:"test",value:function(){this.violated("Rule "+this.name+" has no test!")}},{key:"describe",value:function(){return"Expect "+this.name+" is "+this.category+" on dataLayer"+(this.context?"."+this.context:"")}}]),a}(),k=function(a){function b(a){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.failure;return e(this,b),c(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j.names.required,d,f))}return d(b,a),g(b,[{key:"test",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=!1;if(a[this.name])b=!0;else for(var c=this.fqn.split("."),d=a,e=0;e<c.length&&(d=d[c[e]]);e++)e===c.length-1&&(b=!0);if(!b)return this.violated("Property "+this.fqn+" is required!",{value:a[this.name]},{value:"null",expected:"Some[Any]"})}}]),b}(j);j.RequiredRule=k;var l=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Set,d=arguments[1],f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.failure;e(this,b);var h=c(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,d,j.names.knownKeys,f,g));return"Set"!==a.constructor.names&&(a=new Set(a)),h.knownKeys=a,h}return d(b,a),g(b,[{key:"test",value:function(a){if(!this.knownKeys.has(a[this.name]))return this.violated('Value "'+a[this.name]+'" for property '+this.fqn+" should be one of ["+Array.from(this.knownKeys).join(", ")+"]!",{value:a,expected:this.knownKeys})}},{key:"describe",value:function(){return"Expect "+this.fqn+" to be one of ["+Array.from(this.knownKeys).join(", ")+"]"}}]),b}(j);j.RestrictKeyRule=l;var m=function(a){function b(a,d){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.failure;e(this,b);var h=c(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,d,j.names.equals,f,g));return h.expected=a,h}return d(b,a),g(b,[{key:"test",value:function(a){var b=f(this.fqn,a);if(b!=this.expected)return this.violated(this.fqn+": Value '"+b+"' != '"+this.expected+"'")}}]),b}(j),n=function(a){function b(a,d){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.failure;e(this,b);var h=c(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,d,j.names.equals,f,g));return h.expected=a,h}return d(b,a),g(b,[{key:"test",value:function(a){var b=f(this.fqn,a);if(b!==this.expected)return this.violated(this.fqn+": Value '"+b+"' !== '"+this.expected+"'")}}]),b}(j),o=function(a){function b(a,d){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.failure;e(this,b);var h=c(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,d,j.names.equals,f,g));return h.expected=a,h}return d(b,a),g(b,[{key:"test",value:function(a){var b=f(this.fqn,a)||"";if("string"!=typeof b&&(b=b.toString()),!b.match(this.expected))return this.violated(this.fqn+": String '"+b+"' does not match pattern "+this.expected)}}]),b}(j);j.EqualsRule=m,j.StrictEqualsRule=n,j.StringMatchesRule=o,j.exception=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.stack&&(c.stack=a.stack.split("\n")),new j(a.constructor.name,j.names.exception,b,i.error).violated(a.message,c)},j.custom=function(a,b,f){var h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"error";return new(function(j){function k(){return e(this,k),c(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,b,f,h,i))}return d(k,j),g(k,[{key:"test",value:function(){for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return a.apply(this,c)}}]),k}(j))(b,f,h,i)},j.severities=i,j.names=h,a.exports=j})},{"./violation":22}],19:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","./validator","./rule","./ecommerce/enhanced-ecommerce","./page-type-validator"],e);else if(void 0!==c)e(b,a("./validator"),a("./rule"),a("./ecommerce/enhanced-ecommerce"),a("./page-type-validator"));else{var f={exports:{}};e(f,d.validator,d.rule,d.enhancedEcommerce,d.pageTypeValidator),d.storePageValidator=f.exports}}(this,function(a,b,c,d,e){"use strict";function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j={marketing:{rules:[new c.RequiredRule("impressions","ecommerce")],Top10Page:{rules:[]},Top50Page:{rules:[]},CampaignPage:{rules:[]},CampaignPageSidebars:{rules:[]},Unknown:{rules:[]}},detail:{rules:[new c.RestrictKeyRule(["product"],"bbPageSubType")],product:{rules:[new c.RequiredRule("detail","ecommerce")]}},list:{rules:[new c.RestrictKeyRule(["category","search"],"bbPageSubType"),new c.RequiredRule("impressions","ecommerce")],search:{rules:[new c.RequiredRule("bbNumSearchResults"),new c.RequiredRule("searches"),new c.RequiredRule("searchTerm")]}},cart:{rules:[new c.RestrictKeyRule(["display"],"bbPageSubType")]},checkout:{rules:[new c.RestrictKeyRule(["flow","receipt"],"bbPageSubType")]}},k=function(a){function k(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,k),g(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,a,function(){return[new e(a.bbPageType,j[a.bbPageType],a),b.create(a,[new c.RequiredRule("ecommerce"),new c.RestrictKeyRule(Object.keys(j),"bbPageType")],"storeCore",!0),new d(a)]}))}return h(k,a),i(k,[{key:"shouldBeApplied",value:function(){return"store"===(this.sourceObject.bbPageSiteSection||"").trim().toLowerCase()}}]),k}(b.ChainedValidator);a.exports=k})},{"./ecommerce/enhanced-ecommerce":12,"./page-type-validator":16,"./rule":18,"./validator":21}],20:[function(a,b,c){!function(d,e){if("function"==typeof define&&define.amd)define(["module","./validator","./get-cookie","./rule"],e);else if(void 0!==c)e(b,a("./validator"),a("./get-cookie"),a("./rule"));else{var f={exports:{}};e(f,d.validator,d.getCookie,d.rule),d.userValidator=f.exports}}(this,function(a,b,c,d){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=["bbUserLoginMethod","userId","bbBodyspaceUserId","bbUserJoinDate","bbUserHomeCountry","bbUserHomeState","bbUserHomeCity","bbUserLastLogin","bbUserKruxId"].map(function(a){return new d.RequiredRule(a)}).concat([new d.StringMatchesRule(/\d+/,"userId")]),j=function(a){function b(a){var g;e(this,b);var h=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,[d.custom(function(){!h.sourceObject.bbUserLoggedInStatus&&a.bbUserLoginMethod&&h.violated("Login method "+h.sourceObject.bbUserLoginMethod+" provided for user who is not logged in!",{value:h.sourceObject.bbUserLoginMethod,expected:"null"})},"bbUserLoginMethod",d.name.contradictingState),new d.StringMatchesRule(/^\w+-\w+$/,"bbMetaOmnitureVisitorId"),new d.StringMatchesRule(/^\w+-\w+-\w+-\w+-\w+$/,"bbUserMachineId")]));return c("m")&&new d.StrictEqualsRule(c("m")||"","bbUserMachineId"),c("s_vi")&&new d.StrictEqualsRule((c("s_vi")||"").replace(/\[CS]\w+\|(\w+-\w+)\[CE]/,"$1"),"bbMetaOmnitureVisitorId"),h.sourceObject.bbUserLoggedInStatus&&i.forEach(function(a){a&&h.rules.push(a)}),g=h,f(h,g)}return g(b,a),h(b,[{key:"shouldBeApplied",value:function(a){var b=void 0;try{b=!(!window.sessionStorage||!window.sessionStorage.getItem("bba.profile"))}catch(a){try{window.sessionStorage&&(console.warn("Running in non standard browser environment without sessionStorage. Cannot check if user props actually should be set!"),b=!0)}catch(a){console.warn("Running outside the browser. Cannot check if user props actually should be set!"),b=!0}}return b}}]),b}(b);a.exports=j})},{"./get-cookie":14,"./rule":18,"./validator":21}],21:[function(a,b,c){!function(a,d){if("function"==typeof define&&define.amd)define(["module"],d);else if(void 0!==c)d(b);else{var e={exports:{}};d(e),a.validator=e.exports}}(this,function(a){"use strict";function b(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function c(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments[2],f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!1};d(this,a),this.name=e,this.rules=c.slice(0),this.sourceObject=b,this._active="function"==typeof f?f:function(){return f}}return e(a,[{key:"validate",value:function(){var a=this,b=void 0;try{b=this.rules.map(function(b){try{return b.test(a.sourceObject)}catch(c){return Rule.exception(c,a.name,b)}}).filter(function(a){return!!a})}catch(a){console.error("Validator: %s%s failed. %s",this.constructor.name,this.name?"."+this.name:"",ex.message,ex),b=[Rule.exception(ex,this.name)]}return b}},{key:"shouldBeApplied",value:function(){return this._active()}}]),a}();f.create=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments[2],d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!1};return new f(a,b,c,d)};var g=function(a){function g(a){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]},e=arguments[2];d(this,g);var h=b(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,a,[],e));return h.validators=c(a).slice(0),h.rules=h.rules.concat(f.allActiveRules(h.validators)).slice(0),h}return c(g,a),e(g,[{key:"validate",value:function(){var a=void 0;try{a=f.allViolations(this.validators)}catch(b){console.error("Validator: %s%s failed. %s",this.constructor.name,this.name?"."+this.name:"",ex.message,ex),a=[Rule.exception(ex,this.name)]}return a}},{key:"addValidator",value:function(a){this.validators.push(a),this.rules=this.rules.concat(a.rules)}}]),g}(f);f.allViolations=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(function(a){return a.shouldBeApplied()}).map(function(a){return a.validate()}).reduce(function(a,b){return a.concat(b)},[])},f.allActiveRules=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(function(a){return a.shouldBeApplied()}).map(function(a){return a.rules.slice(0)}).reduce(function(a,b){return a.concat(b)},[])},f.ChainedValidator=g,a.exports=f})},{}],22:[function(a,b,c){!function(a,d){if("function"==typeof define&&define.amd)define(["module"],d);else if(void 0!==c)d(b);else{var e={exports:{}};d(e),a.violation=e.exports}}(this,function(a){"use strict";function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var c=function a(c){var d=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};b(this,a),this.message=e||c.describe(),this.rule=c,Object.keys(f).forEach(function(a){return d[a]=f[a]})};a.exports=c})},{}],23:[function(a,b,c){b.exports={name:"@bbcom/datalayer-validator",version:"1.2.3",main:"datalayer-validator.js",repository:"git@github.body.prod:clientside/datalayer-validator.git",author:"Ben Tilford <ben.tilford@bodybuilding.com>",license:"MIT",dependencies:{argparse:"^1.0.9","babel-register":"^6.26.0","browserify-versionify":"^1.0.6",chalk:"^2.3.0","chrome-remote-interface":"^0.25.5","grunt-chrome-headless":"^0.1.1",puppeteer:"^0.13.0"},publishConfig:{registry:"http://artifactory.body.prod/api/npm/npm-local"},scripts:{release:"open http://ci-m1.body.prod/view/CSE/job/cse.release",deploy:"open http://ci-m1.body.prod/view/CSE/job/cse.deploy",github:"open http://github.body.prod/clientside/datalayer-validator"},devDependencies:{"babel-core":"^6.26.0","babel-eslint":"7","babel-preset-env":"^1.6.1","babel-preset-es2015":"^6.24.1",babelify:"^8.0.0","browserify-derequire":"^0.9.4",deamdify:"^0.3.0",decomponentify:"^0.1.0",deumdify:"^1.2.4",eslint:"3.x",grunt:"^1.0.1","grunt-bbcom-deployer":"^1.1.5","grunt-browserify":"^5.2.0","grunt-build-info":"^1.0.6","grunt-bump":"^0.8.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-concat":"^1.0.1","grunt-contrib-uglify":"^3.2.1","grunt-contrib-watch":"^1.0.0","grunt-docco-plus":"^3.0.0","grunt-eslint":"^20.1.0","grunt-git":"^1.0.9","grunt-shell":"^2.1.0",jasmine:"^3.1.0","jasmine-reporters":"^2.3.0",jsonlint:"^1.6.2","load-grunt-config":"^0.19.2"},browserify:{transform:["browserify-versionify","decomponentify",["babelify",{presets:"es2015",plugins:["transform-es2015-modules-umd"]}]]}}},{}],24:[function(a,b,c){b.exports={name:"@bbcom/bb-analytics",version:"1.7.0",main:"index.js",license:"MIT",devDependencies:{"babel-core":"^6.26.0","babel-eslint":"7","babel-plugin-transform-es2015-modules-amd":"^6.24.1","babel-preset-env":"^1.6.1","babel-preset-es2015":"^6.24.1",babelify:"^8.0.0","browserify-versionify":"^1.0.6",deamdify:"^0.3.0",decomponentify:"^0.1.0",deglobalify:"^0.2.0",dependify:"^0.0.1",es6ify:"^1.6.0",grunt:"^1.0.1","grunt-bbcom-deployer":"^1.0.0","grunt-browserify":"^5.2.0","grunt-build-info":"^1.0.4","grunt-bump":"^0.8.0","grunt-contrib-clean":"^1.0.0","grunt-contrib-concat":"^1.0.1","grunt-contrib-connect":"^1.0.2","grunt-contrib-jasmine":"^1.0.0","grunt-contrib-requirejs":"^1.0.0","grunt-contrib-uglify":"^2.0.0","grunt-contrib-watch":"^1.0.0","grunt-docco-plus":"^3.0.0","grunt-eslint":"^19.0.0","grunt-git":"^1.0.1","grunt-ngdocs":"^0.2.9","grunt-shell":"^2.1.0","grunt-template-jasmine-requirejs":"^0.2.3",jsonlint:"^1.6.2","load-grunt-config":"^0.19.1",remapify:"^2.1.0","serve-static":"^1.13.1"},publishConfig:{registry:"http://artifactory.body.prod/api/npm/npm-local"},dependencies:{"@bbcom/datalayer-validator":"^1"}}},{}]},{},[7]);